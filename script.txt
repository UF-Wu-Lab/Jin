*** k-mer analysis 

module load kmc/3.2.1  
$ mkdir tmp
$ ls *.fastq > FILES
$ kmc -k21 -t10 -m64 -ci1 -cs10000 @FILES reads tmp/

$ kmc_tools transform reads histogram reads.histo -cx10000


*** hifiasm assembly (-l 0 to 3 for different purge levels)

hifiasm -o Haden -t 12 -l 3 m64310e_230506_034722.hifi_reads.filt.fastq.gz 


*** HiCanu Assembly

canu -p mango -d haden_hifi genomeSize=350m -pacbio-hifi /blue/xingbo.wu/share/mango/Haden/m64310e_230506_034722.hifi_reads.filt.fastq.gz

*** convert gfa to fasta (-w line width)

awk '/^S/ {print ">"$2"\n"$3}' hifiasm.asm.bp.p_ctg.gfa | seqkit seq -w 60 > Haden.hifi_assembled.fasta

*** ragtag scaffolding

ragtag.py scaffold <reference_genome.fasta> Haden.p_ctg.fa -o Haden_assembly -t 12 


*** A Telomere Identification toolKit (tidk)

conda create -n tidk_env -c bioconda tidk

conda activate tidk_env

tidk search --string AAACCCT --output tidk_output --dir ./ ragtag.scaffold.fasta

** plot

tidk plot --tsv tidk_output_telomeric_repeat_windows.tsv

**** get chr form ragtag.scaffold.fasta

#!/bin/bash

# Create the ./chr directory if it doesn't exist
mkdir -p ./chr

# Loop through chromosome numbers 1 to 20
for i in {1..20}; do
  head -$((2 * i)) ragtag.scaffold.fasta | tail -2 > ./chr/ch$i
done

**** extract sequence containing 5'end telomere from fastq file

# Extract lines from FASTQ file
grep -B 1 'AGGGTTTAGGGTTTAGGGTTTAGGGTTT' m64310e_230506_034722.hifi_reads.fastq | sed 's/@/>/g' > ./AGGGTTT/AGGGTTT.fasta


**** blast
conda activate blast
makeblastdb -in AGGGTTT.fasta -dbtype nucl -out AGGGTTT_db
blastn -query query.fasta -db AGGGTTT_db -out results.txt -outfmt 6 -evalue 1e-5 -max_target_seqs 10 -num_threads 4

**** extract specific sequence from fasta
grep -A 1 "m64310e_230506_034722/132711129/ccs" AGGGTTT.fasta


